<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <meta charset="UTF-8" />
    <title>Energy subsidies</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.12.0/d3.min.js"></script>
    <script src="https://cdn.polyfill.io/v2/polyfill.js"></script>
    <script src="dev-js/scripts.js"></script>
    <link rel="stylesheet" type="text/css" href="http://www.rff.org/sites/all/themes/rff_theme/css/styles.css?p05msg" />
    <link rel="stylesheet" type="text/css" href="dev-css/styles.css" />
</head>
<body style="max-width: 728px;margin: 0 auto;">
    <p><strong>Settings</strong></p>
    <form id="forms">
        <div>
            <input onchange="changeHandler()" id="profit" type="radio" name="type" value="profit" checked />
            <label for="profit">Profit guarantee</label>
            <input onchange="changeHandler()" id="cost" type="radio" name="type" value="cost" />
            <label for="profit">Costs only</label>
        </div>

        <div>
            <input onchange="changeHandler()" id="both" type="radio" name="target" value="both" checked />
            <label for="both">Coal and nuclear</label>
            <input onchange="changeHandler()" id="nuclear" type="radio" name="target" value="nuclear" />
            <label for="nuclear">Nuclear only</label>
            <input onchange="changeHandler()" id="coal" type="radio" name="target" value="coal" />
            <label for="coal">Coal only</label>
        </div>

        <div>
            <input onchange="changeHandler()" id="twenty-five" type="radio" name="length" value="25" checked />
            <label for="twenty-five">25 years</label>
            <input onchange="changeHandler()" id="ten" type="radio" name="length" value="10" />
            <label for="ten">10 years</label>
        </div>
    </form>
    
    <div class="d3-group" data-sheet-id="1_G9HsJbxRBd7fWTF51Xr8lpxGxxImVcc-rTIaQbEeyA" data-nest-by='["category","series"]' data-data-tab="Sheet1" data-dictionary-tab="dictionary" data-variable-y="pb25l_value" data-variable-x="year" data-type="line" data-svg-width="320" data-direct-label="true" data-scale-by='["pb25l_value","pb10l_value", "pc10l_value", "pn10l_value", "cb25l_value", "cb10l_value", "cb10l_value","cn10l_value"]'>
        <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Placeat commodi vero natus sed exercitationem beatae nam incidunt suscipit enim, repellat dolore dignissimos veritatis odit earum itaque! Debitis enim dolore magni.
        </p>
        <div class="d3-chart" data-category="generation" data-series='all' data-series-group='all'></div>
        <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Mollitia in quo libero ea. Eligendi quidem ducimus eaque. Nihil sapiente, qui ut vitae velit maxime aliquam, debitis, aliquid natus, nobis ullam.
        </p>
         <div class="d3-chart" data-category="emissions" data-series="all" data-series-group='[["carbon"],["sulfur","nitrogen"]]' data-reset-scale='["carbon", "sulfur"]'></div>
        <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nam provident quis consequatur id beatae doloribus veniam eius molestiae, ducimus eum maxime totam reprehenderit, ipsa aperiam? Iste quaerat quam beatae autem!
        </p>
         <div class="d3-chart" data-category="death" data-series="all" data-series-group='"none"'></div>
        <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quae sequi harum magni officia dignissimos doloribus nisi quibusdam quidem consectetur debitis aliquid itaque quaerat, praesentium! Rem maiores ea ullam vitae doloribus.
        </p>
         <div class="d3-chart" data-category="price" data-series="all" data-series-group='[["total_price","lmp","uplift"]]' data-margin-right="75"></div>
        <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sed, nulla, itaque! Enim earum et magni possimus, ipsam labore itaque, ratione, delectus fugit ullam nostrum totam, aliquam veritatis repellendus! Recusandae, amet.
        </p>
         <div class="d3-chart" data-category="benefits" data-series="all" data-series-group='[["total","end-user", "environmental","generator"]]' data-margin-right="75" data-x-axis-position="zero"></div>
        <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt nisi deserunt explicabo dolore reiciendis beatae ut laudantium delectus, est alias ipsa. Consequuntur excepturi tenetur nobis incidunt esse, molestias modi odit.
        </p> 
    </div>
    <script type="text/javascript">
        D3Charts.Init();
            var _this = this;
            var userSelectedTen = false;
            var form = document.querySelector('#forms');
            form.querySelectorAll('input').forEach(function(each){
                each.onchange = function(){
                    if ( this.value === '10' ){
                        userSelectedTen = true;
                    } else if ( this.value === '25' ){
                        userSelectedTen = false;
                    }
                    console.log(userSelectedTen);
                    if ( this.value === 'nuclear' || this.value === 'coal' ){
                        document.querySelector('input#twenty-five').checked = false;
                        document.querySelector('input#twenty-five').setAttribute('disabled', true);
                        document.querySelector('input#ten').setAttribute('disabled', true);
                        document.querySelector('input#ten').checked = true;
                    } else if ( this.value === 'both' ){
                        document.querySelector('input#twenty-five').removeAttribute('disabled');
                        document.querySelector('input#ten').removeAttribute('disabled');
                        if ( !userSelectedTen ) {
                            document.querySelector('input#ten').checked = false;
                            document.querySelector('input#twenty-five').checked = true;
                        }
                    } 
                    var forms = document.querySelector('#forms');
                    var inputs = forms.querySelectorAll('input');
                    var values = [];
                    var variableY;
                    for (let i = 0; i < inputs.length; i++){
                        if ( inputs[i].checked ){
                            values.push(inputs[i].value);
                        }
                    }
                    switch (values.join('-')){
                        case 'profit-both-25':
                            variableY = 'pb25l_value';
                            break;
                        case 'profit-both-10':
                            variableY = 'pb10l_value';
                            break;
                        case 'profit-coal-10':
                            variableY = 'pc10l_value';
                            break;
                        case 'profit-nuclear-10':
                            variableY = 'pn10l_value';
                            break;
                        case 'cost-both-25':
                            variableY = 'cb25l_value';
                            break;
                        case 'cost-both-10':
                            variableY = 'cb10l_value';
                            break;
                        case 'cost-coal-10':
                            variableY = 'cc10l_value';
                            break;
                        case 'cost-nuclear-10':
                            variableY = 'cn10l_value';
                            break;
                    }
                    D3Charts.UpdateAll(variableY);

                }
            });
        
    </script>  
</body>
</html>